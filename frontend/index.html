<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HackHub - Collaborative Hackathon Platform</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #0f172a; /* slate-900 */
      }
      .modal-backdrop {
        background-color: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(8px);
      }
      .card {
        background-color: #1e293b; /* slate-800 */
        border: 1px solid #334155; /* slate-700 */
        border-radius: 0.75rem;
        padding: 1.5rem;
        transition: all 0.3s ease;
      }
      .card:hover {
        border-color: #38bdf8; /* sky-400 */
      }
      .nav-item {
        display: flex;
        align-items: center;
        padding: 0.75rem 1rem;
        border-radius: 0.5rem;
        color: #94a3b8; /* slate-400 */
        transition: all 0.2s ease;
        cursor: pointer;
      }
      .nav-item:hover,
      .nav-item.active {
        background-color: #334155; /* slate-700 */
        color: #f8fafc; /* slate-50 */
      }
      .nav-item .icon {
        font-size: 1.25rem;
        margin-right: 1rem;
      }
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #1e293b; /* slate-800 */
      }
      ::-webkit-scrollbar-thumb {
        background: #475569; /* slate-600 */
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #64748b; /* slate-500 */
      }
      .chart-container {
        position: relative;
        width: 100%;
        max-width: 400px;
        margin-left: auto;
        margin-right: auto;
        height: auto;
        max-height: 400px;
      }
      .loader {
        width: 48px;
        height: 48px;
        border: 5px solid #fff;
        border-bottom-color: #38bdf8;
        border-radius: 50%;
        display: inline-block;
        box-sizing: border-box;
        animation: rotation 1s linear infinite;
      }
      @keyframes rotation {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
      /* Style for datetime-local icon */
      input[type="datetime-local"]::-webkit-calendar-picker-indicator {
        filter: invert(1);
      }
    </style>
  </head>
  <body class="text-slate-200">
    <div id="app-wrapper" class="hidden">
      <div class="flex h-screen bg-slate-900">
        <!-- Left Navigation Sidebar -->
        <nav
          id="sidebar"
          class="w-64 p-4 border-r border-slate-800 flex-shrink-0 flex flex-col justify-between"
        >
          <div>
            <div class="flex items-center mb-8">
              <span class="text-2xl font-bold text-sky-400">H</span>
              <h1 class="text-xl font-bold ml-2">HackHub</h1>
            </div>
            <ul class="space-y-2">
              <li>
                <a
                  onclick="switchView('dashboard')"
                  class="nav-item active"
                  data-view="dashboard"
                  ><span class="icon">üè†</span> Dashboard</a
                >
              </li>
              <li>
                <a
                  onclick="switchView('tasks')"
                  class="nav-item"
                  data-view="tasks"
                  ><span class="icon">üìã</span> Tasks</a
                >
              </li>
              <li>
                <a
                  onclick="switchView('chat')"
                  class="nav-item"
                  data-view="chat"
                  ><span class="icon">üí¨</span> Team Chat</a
                >
              </li>
              <li>
                <a
                  onclick="switchView('pitch')"
                  class="nav-item"
                  data-view="pitch"
                  ><span class="icon">üí°</span> AI Pitch Gen</a
                >
              </li>
              <li>
                <a
                  onclick="switchView('files')"
                  class="nav-item"
                  data-view="files"
                  ><span class="icon">üìÅ</span> Files & Links</a
                >
              </li>
              <li>
                <a
                  onclick="switchView('team')"
                  class="nav-item"
                  data-view="team"
                  ><span class="icon">üë•</span> Team Settings</a
                >
              </li>
            </ul>
          </div>
          <div class="border-t border-slate-700 pt-4">
            <div class="flex items-center">
              <img
                id="user-avatar"
                src="https://placehold.co/40x40/38bdf8/ffffff?text=D"
                alt="User Avatar"
                class="w-10 h-10 rounded-full"
              />
              <div class="ml-3">
                <p id="user-name" class="font-semibold">Dia</p>
                <a
                  href="#"
                  onclick="logout()"
                  class="text-sm text-slate-400 hover:text-sky-400"
                  >Logout</a
                >
              </div>
            </div>
          </div>
        </nav>

        <!-- Main Content Panel -->
        <main class="flex-1 p-6 md:p-8 overflow-y-auto">
          <div id="view-dashboard" class="view-content">
            <h2 class="text-3xl font-bold mb-6">Team Dashboard</h2>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
              <!-- Progress Chart -->
              <div class="card lg:col-span-2">
                <h3 class="font-semibold mb-4 text-lg">Project Progress</h3>
                <p class="text-sm text-slate-400 mb-4">
                  This chart visualizes your team's task completion status.
                  Hover over the segments to see the exact number of tasks in
                  each category. This helps in quickly assessing the overall
                  progress towards the hackathon deadline.
                </p>
                <div class="chart-container">
                  <canvas id="progressChart"></canvas>
                </div>
              </div>
              <!-- Team Intro -->
              <div class="card">
                <h3 id="dashboard-team-name" class="font-semibold mb-4 text-lg">
                  Team Synapse
                </h3>
                <img
                  src="https://placehold.co/100x100/1e293b/38bdf8?text=S"
                  alt="Team Logo"
                  class="w-24 h-24 rounded-full mx-auto mb-4 border-2 border-slate-700"
                />
                <p class="text-slate-400 text-sm text-center">
                  "Building the future, one line of code at a time. We're a
                  passionate team of developers and designers focused on
                  creating impactful AI-driven solutions."
                </p>
                <button
                  class="w-full mt-4 bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-lg transition-colors"
                >
                  Edit Bio
                </button>
              </div>
            </div>
            <div class="card mt-6">
              <h3 class="font-semibold mb-4 text-lg">Upcoming Tasks</h3>
              <div id="dashboard-upcoming-tasks" class="space-y-3">
                <!-- Upcoming tasks will be populated dynamically -->
              </div>
            </div>
          </div>

          <div id="view-tasks" class="view-content hidden">
            <div class="flex justify-between items-center mb-6">
              <h2 class="text-3xl font-bold">Task Board</h2>
              <button
                onclick="openAddTaskModal()"
                class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-lg transition-colors"
              >
                Add New Task
              </button>
            </div>
            <p class="text-slate-400 mb-6 max-w-3xl">
              This is your team's Kanban board. It provides a clear overview of
              all tasks and their current status. Click the 'Update Status'
              button on any task card to move it to a different column, helping
              everyone stay synchronized on the project's workflow.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
              <!-- To Do -->
              <div class="bg-slate-800 p-4 rounded-lg">
                <h3 class="font-semibold text-lg mb-4 text-center text-red-400">
                  To Do
                </h3>
                <div id="tasks-todo" class="space-y-4 min-h-[100px]">
                  <!-- Tasks will be populated here -->
                </div>
              </div>
              <!-- In Progress -->
              <div class="bg-slate-800 p-4 rounded-lg">
                <h3
                  class="font-semibold text-lg mb-4 text-center text-yellow-400"
                >
                  In Progress
                </h3>
                <div id="tasks-inprogress" class="space-y-4 min-h-[100px]">
                  <!-- Tasks will be populated here -->
                </div>
              </div>
              <!-- Done -->
              <div class="bg-slate-800 p-4 rounded-lg">
                <h3
                  class="font-semibold text-lg mb-4 text-center text-green-400"
                >
                  Done
                </h3>
                <div id="tasks-done" class="space-y-4 min-h-[100px]">
                  <!-- Tasks will be populated here -->
                </div>
              </div>
            </div>
          </div>

          <div id="view-chat" class="view-content hidden">
            <h2 class="text-3xl font-bold mb-2">Team Chat</h2>
            <p class="text-slate-400 mb-6 max-w-3xl">
              This is your central communication hub. All team chat happens here
              in real-time. If you need a quick catch-up on the conversation,
              use the 'Summarize Chat with AI' button to get a condensed
              overview of recent discussions.
            </p>
            <div class="card h-[70vh] flex flex-col">
              <div
                class="flex justify-between items-center border-b border-slate-700 pb-3 mb-4"
              >
                <h3 class="font-semibold">#general</h3>
                <button
                  onclick="summarizeChat()"
                  class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-lg transition-colors text-sm"
                >
                  ‚ú® Summarize Chat
                </button>
              </div>
              <div
                id="chat-messages"
                class="flex-1 overflow-y-auto space-y-4 pr-2"
              >
                <!-- Chat Messages -->
                <div class="flex items-start gap-3 chat-message">
                  <img
                    src="https://placehold.co/40x40/ca8a04/ffffff?text=A"
                    class="w-10 h-10 rounded-full"
                    alt="Aastha"
                  />
                  <div>
                    <p class="font-semibold">
                      Aastha
                      <span class="text-xs text-slate-500 ml-2">3:40 PM</span>
                    </p>
                    <div
                      class="bg-slate-700 p-3 rounded-lg mt-1 inline-block message-text"
                    >
                      Backend structure is mostly done. I'm pushing the initial
                      models now.
                    </div>
                  </div>
                </div>
                <div class="flex items-start gap-3 chat-message">
                  <img
                    src="https://placehold.co/40x40/be185d/ffffff?text=A"
                    class="w-10 h-10 rounded-full"
                    alt="Aarti"
                  />
                  <div>
                    <p class="font-semibold">
                      Aarti
                      <span class="text-xs text-slate-500 ml-2">3:42 PM</span>
                    </p>
                    <div
                      class="bg-slate-700 p-3 rounded-lg mt-1 inline-block message-text"
                    >
                      Great! Anushka and I will start integrating the pitch
                      generator API then.
                    </div>
                  </div>
                </div>
                <div class="flex items-start gap-3 chat-message">
                  <img
                    src="https://placehold.co/40x40/38bdf8/ffffff?text=D"
                    class="w-10 h-10 rounded-full"
                    alt="Dia"
                  />
                  <div>
                    <p class="font-semibold">
                      Dia
                      <span class="text-xs text-slate-500 ml-2">3:45 PM</span>
                    </p>
                    <div
                      class="bg-sky-600 p-3 rounded-lg mt-1 inline-block message-text"
                    >
                      Dashboard UI is coming along nicely! The progress chart is
                      now live.
                    </div>
                  </div>
                </div>
              </div>
              <div class="mt-4 pt-4 border-t border-slate-700">
                <input
                  type="text"
                  placeholder="Type your message..."
                  class="w-full bg-slate-700 border border-slate-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500"
                />
              </div>
            </div>
          </div>

          <div id="view-pitch" class="view-content hidden">
            <h2 class="text-3xl font-bold mb-2">AI Pitch Generator</h2>
            <p class="text-slate-400 mb-6 max-w-3xl">
              Struggling to articulate your project's vision? Simply enter your
              core ideas as bullet points in the text area below. Our AI
              assistant will analyze them and generate a concise, compelling
              summary perfect for your final pitch.
            </p>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
              <div class="card">
                <h3 class="font-semibold text-lg mb-4">Your Bullet Points</h3>
                <textarea
                  id="pitch-input"
                  class="w-full h-64 bg-slate-900 border border-slate-700 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"
                  placeholder="- AI-powered collaboration hub&#x0a;- Real-time task tracking&#x0a;- Automated pitch generation&#x0a;- Centralized file storage"
                ></textarea>
                <button
                  onclick="generatePitch()"
                  class="w-full mt-4 bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-lg transition-colors"
                >
                  ‚ú® Generate Pitch
                </button>
              </div>
              <div class="card">
                <h3 class="font-semibold text-lg mb-4">
                  Generated Pitch Summary
                </h3>
                <div
                  id="pitch-output"
                  class="w-full h-64 bg-slate-900 border border-dashed border-slate-600 rounded-lg p-4 text-sm text-slate-400 overflow-y-auto"
                >
                  <p>Your generated pitch will appear here...</p>
                </div>
                <div id="ai-assistant-section" class="mt-4 hidden">
                  <h4 class="font-semibold text-md mb-2">
                    AI Assistant Suggestion
                  </h4>
                  <p
                    id="ai-assistant-output"
                    class="text-sm bg-slate-900 p-3 rounded-lg border border-slate-700"
                  >
                    Click the button below for improvement ideas!
                  </p>
                  <button
                    onclick="getPitchImprovements()"
                    class="w-full mt-2 bg-slate-600 hover:bg-slate-700 text-white font-bold py-2 px-4 rounded-lg transition-colors text-sm"
                  >
                    ‚ú® Suggest Improvements
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div id="view-files" class="view-content hidden">
            <h2 class="text-3xl font-bold mb-6">Files & Links</h2>
            <p class="text-slate-400 mb-6 max-w-3xl">
              This section is your team's shared repository. Upload important
              documents, presentations, and whiteboard snapshots. You can also
              save and share crucial web links, ensuring everyone has access to
              the same resources.
            </p>
            <div class="card mb-6">
              <div class="flex justify-between items-center mb-4">
                <h3 class="font-semibold text-lg">Uploaded Files</h3>
                <button
                  class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-lg transition-colors text-sm"
                >
                  Upload File
                </button>
              </div>
              <div
                class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"
              >
                <div class="p-3 bg-slate-900 rounded-lg text-center">
                  <span class="text-4xl">üìÑ</span>
                  <p class="text-sm mt-2 truncate">Project_Brief.pdf</p>
                </div>
                <div class="p-3 bg-slate-900 rounded-lg text-center">
                  <span class="text-4xl">üñºÔ∏è</span>
                  <p class="text-sm mt-2 truncate">Whiteboard_Flow.png</p>
                </div>
                <div class="p-3 bg-slate-900 rounded-lg text-center">
                  <span class="text-4xl">üìä</span>
                  <p class="text-sm mt-2 truncate">Final_Pitch.pptx</p>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="flex justify-between items-center mb-4">
                <h3 class="font-semibold text-lg">Saved Important Links</h3>
                <button
                  class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-lg transition-colors text-sm"
                >
                  Add Link
                </button>
              </div>
              <ul class="space-y-2">
                <li
                  class="flex items-center justify-between p-3 bg-slate-900 rounded-lg"
                >
                  <a href="#" class="text-sky-400 hover:underline truncate"
                    >Tailwind CSS Documentation</a
                  >
                  <span class="text-xs text-slate-500">Design Reference</span>
                </li>
                <li
                  class="flex items-center justify-between p-3 bg-slate-900 rounded-lg"
                >
                  <a href="#" class="text-sky-400 hover:underline truncate"
                    >Chart.js Examples</a
                  >
                  <span class="text-xs text-slate-500">Frontend Lib</span>
                </li>
              </ul>
            </div>
          </div>

          <div id="view-team" class="view-content hidden">
            <h2 class="text-3xl font-bold mb-6">Team Settings</h2>
            <p class="text-slate-400 mb-6 max-w-3xl">
              Manage your team's identity and member roles here. You can update
              the team bio that appears on the dashboard and assign specific
              roles to each member to clarify responsibilities. Your unique
              invite code is also available here to share with new members.
            </p>
            <div class="card mb-6">
              <h3 class="font-semibold text-lg mb-4">Team Profile</h3>
              <div class="space-y-4">
                <div>
                  <label class="text-sm font-medium text-slate-400"
                    >Team Name</label
                  >
                  <input
                    type="text"
                    id="settings-team-name"
                    value="Team Synapse"
                    class="w-full mt-1 bg-slate-700 border border-slate-600 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-sky-500"
                  />
                </div>
                <div>
                  <label class="text-sm font-medium text-slate-400"
                    >Team Bio</label
                  >
                  <textarea
                    class="w-full mt-1 h-24 bg-slate-700 border border-slate-600 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-sky-500"
                  >
Building the future, one line of code at a time. We're a passionate team of developers and designers focused on creating impactful AI-driven solutions.</textarea
                  >
                </div>
                <div>
                  <label class="text-sm font-medium text-slate-400"
                    >Team Invite Code</label
                  >
                  <div class="flex items-center gap-2 mt-1">
                    <input
                      type="text"
                      readonly
                      id="settings-invite-code"
                      value="HACK-25-XYZ"
                      class="w-full bg-slate-900 border border-slate-600 rounded-lg p-2 font-mono"
                    />
                    <button
                      class="bg-slate-600 hover:bg-slate-700 text-white font-bold py-2 px-4 rounded-lg transition-colors text-sm"
                    >
                      Copy
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <div class="card">
              <h3 class="font-semibold text-lg mb-4">Manage Members</h3>
              <div id="settings-members-list" class="space-y-3">
                <!-- Member list will be dynamically populated here -->
              </div>
            </div>
          </div>

          <!-- Team Setup View -->
          <div id="view-team-setup" class="view-content hidden">
            <div class="max-w-2xl mx-auto">
              <div class="card text-center">
                <h2 class="text-3xl font-bold mb-2">Setup Your Team</h2>
                <p class="text-slate-400 mb-6">
                  As the team leader, please add your team members below.
                </p>
                <form
                  id="team-setup-form"
                  onsubmit="event.preventDefault(); generateTeamCode()"
                >
                  <div class="mb-4 text-left">
                    <label class="text-sm font-medium text-slate-400"
                      >Team Name</label
                    >
                    <input
                      type="text"
                      id="setup-team-name"
                      placeholder="e.g., The Code Crusaders"
                      class="w-full mt-1 bg-slate-700 border border-slate-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500"
                      required
                    />
                  </div>
                  <div class="mb-4 text-left">
                    <label class="text-sm font-medium text-slate-400"
                      >Hackathon Deadline</label
                    >
                    <input
                      type="datetime-local"
                      id="setup-deadline"
                      class="w-full mt-1 bg-slate-700 border border-slate-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500 text-slate-200"
                      required
                    />
                  </div>
                  <div
                    id="team-members-container"
                    class="space-y-3 mb-4 text-left"
                  >
                    <!-- Member input fields will be added here -->
                  </div>
                  <button
                    type="button"
                    onclick="addMemberInput()"
                    class="w-full mb-4 bg-slate-600 hover:bg-slate-700 text-white font-bold py-2 px-4 rounded-lg transition-colors text-sm"
                  >
                    Add Another Member
                  </button>
                  <button
                    type="submit"
                    class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-4 rounded-lg transition-colors"
                  >
                    Create Team & Generate Code
                  </button>
                </form>
              </div>
            </div>
          </div>
        </main>

        <!-- Right Contextual Sidebar -->
        <aside
          id="right-sidebar"
          class="w-72 p-4 border-l border-slate-800 hidden lg:block"
        >
          <!-- Timer -->
          <div class="card text-center mb-6">
            <h3 class="font-semibold mb-2">Hackathon Ends In:</h3>
            <div id="timer" class="text-3xl font-bold text-sky-400 font-mono">
              --:--:--
            </div>
          </div>

          <!-- Notifications -->
          <div class="mb-6">
            <h3 class="font-semibold mb-3">Notifications</h3>
            <div class="space-y-3 text-sm">
              <div class="flex items-start gap-3 p-3 bg-slate-800 rounded-lg">
                <span class="mt-1">üí¨</span>
                <p>
                  <span class="font-semibold">Anshu</span> mentioned you in
                  #general.
                </p>
              </div>
              <div class="flex items-start gap-3 p-3 bg-slate-800 rounded-lg">
                <span class="mt-1">üìã</span>
                <p>
                  <span class="font-semibold">Aastha</span> completed task 'Set
                  up Database'.
                </p>
              </div>
            </div>
          </div>

          <!-- Team Members -->
          <div>
            <h3 class="font-semibold mb-3">Team Members</h3>
            <ul id="sidebar-members-list" class="space-y-3">
              <!-- Sidebar member list will be dynamically populated -->
            </ul>
          </div>
        </aside>
      </div>
    </div>

    <!-- Auth Modal -->
    <div
      id="auth-modal"
      class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop"
    >
      <div class="card w-full max-w-md" id="auth-card">
        <!-- Initial View -->
        <div id="initial-view">
          <h2 class="text-2xl font-bold text-center mb-2">
            Welcome to HackHub
          </h2>
          <p class="text-center text-slate-400 mb-6">
            The ultimate platform for hackathon collaboration.
          </p>
          <div class="space-y-4">
            <button
              onclick="showAuthView('login-view')"
              class="w-full bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 px-4 rounded-lg transition-colors"
            >
              Login
            </button>
            <button
              onclick="showAuthView('signup-view')"
              class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-4 rounded-lg transition-colors"
            >
              Create a New Team (Sign Up)
            </button>
            <button
              onclick="showAuthView('join-view')"
              class="w-full border border-sky-500 text-sky-400 hover:bg-sky-900 font-bold py-3 px-4 rounded-lg transition-colors"
            >
              Join a Team with Code
            </button>
          </div>
        </div>
        <!-- Login View -->
        <div id="login-view" class="hidden">
          <h2 class="text-2xl font-bold text-center mb-6">Login</h2>
          <form onsubmit="event.preventDefault(); login()">
            <div class="mb-4">
              <label class="block text-sm font-medium mb-1 text-slate-400"
                >Email</label
              >
              <input
                type="email"
                class="w-full bg-slate-700 border border-slate-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500"
                required
              />
            </div>
            <div class="mb-6">
              <label class="block text-sm font-medium mb-1 text-slate-400"
                >Password</label
              >
              <input
                type="password"
                class="w-full bg-slate-700 border border-slate-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500"
                required
              />
            </div>
            <button
              type="submit"
              class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-4 rounded-lg transition-colors"
            >
              Login
            </button>
          </form>
          <p class="text-center text-sm text-slate-400 mt-6">
            <a
              href="#"
              onclick="showAuthView('initial-view')"
              class="font-semibold text-sky-400 hover:underline"
              >‚Üê Back</a
            >
          </p>
        </div>
        <!-- Signup View (Leader) -->
        <div id="signup-view" class="hidden">
          <h2 class="text-2xl font-bold text-center mb-6">Create Your Team</h2>
          <form onsubmit="event.preventDefault(); signupLeader()">
            <div class="mb-4">
              <label class="block text-sm font-medium mb-1 text-slate-400"
                >Your Name (Leader)</label
              >
              <input
                type="text"
                id="signup-name"
                class="w-full bg-slate-700 border border-slate-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium mb-1 text-slate-400"
                >Email</label
              >
              <input
                type="email"
                id="signup-email"
                class="w-full bg-slate-700 border border-slate-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500"
                required
              />
            </div>
            <div class="mb-6">
              <label class="block text-sm font-medium mb-1 text-slate-400"
                >Password</label
              >
              <input
                type="password"
                id="signup-password"
                class="w-full bg-slate-700 border border-slate-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500"
                required
              />
            </div>
            <button
              type="submit"
              class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-4 rounded-lg transition-colors"
            >
              Sign Up & Create Team
            </button>
          </form>
          <p class="text-center text-sm text-slate-400 mt-6">
            <a
              href="#"
              onclick="showAuthView('initial-view')"
              class="font-semibold text-sky-400 hover:underline"
              >‚Üê Back</a
            >
          </p>
        </div>
        <!-- Join View (Member) -->
        <div id="join-view" class="hidden">
          <h2 class="text-2xl font-bold text-center mb-6">Join Your Team</h2>
          <form onsubmit="event.preventDefault(); joinTeam()">
            <div class="mb-4">
              <label class="block text-sm font-medium mb-1 text-slate-400"
                >Team Invite Code</label
              >
              <input
                type="text"
                id="join-code"
                class="w-full bg-slate-700 border border-slate-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500 font-mono"
                required
              />
            </div>
            <div id="join-member-select-container" class="mb-4 hidden">
              <label class="block text-sm font-medium mb-1 text-slate-400"
                >Select Your Name</label
              >
              <select
                id="join-member-select"
                class="w-full bg-slate-700 border border-slate-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500"
                required
              ></select>
            </div>
            <div id="join-password-container" class="mb-6 hidden">
              <label class="block text-sm font-medium mb-1 text-slate-400"
                >Set Your Password</label
              >
              <input
                type="password"
                id="join-password"
                class="w-full bg-slate-700 border border-slate-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500"
                required
              />
            </div>
            <button
              type="submit"
              id="join-team-button"
              class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-4 rounded-lg transition-colors"
            >
              Find Team
            </button>
          </form>
          <p class="text-center text-sm text-slate-400 mt-6">
            <a
              href="#"
              onclick="showAuthView('initial-view')"
              class="font-semibold text-sky-400 hover:underline"
              >‚Üê Back</a
            >
          </p>
        </div>
      </div>
    </div>

    <!-- Add Task Modal -->
    <div
      id="add-task-modal"
      class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop"
    >
      <div class="card w-full max-w-lg">
        <h2 class="text-2xl font-bold mb-6">Add New Task</h2>
        <form id="add-task-form" onsubmit="event.preventDefault(); addTask()">
          <div class="mb-4">
            <label
              for="task-title"
              class="block text-sm font-medium mb-1 text-slate-400"
              >Task Title</label
            >
            <input
              type="text"
              id="task-title"
              class="w-full bg-slate-700 border border-slate-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500"
              required
            />
          </div>
          <div class="mb-6">
            <label
              for="task-assignee"
              class="block text-sm font-medium mb-1 text-slate-400"
              >Assign To</label
            >
            <select
              id="task-assignee"
              class="w-full bg-slate-700 border border-slate-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500"
              required
            ></select>
          </div>
          <div class="flex gap-4">
            <button
              type="button"
              onclick="closeAddTaskModal()"
              class="w-full bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 px-4 rounded-lg transition-colors"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-4 rounded-lg transition-colors"
            >
              Add Task
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Update Task Status Modal -->
    <div
      id="update-task-modal"
      class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop"
    >
      <div class="card w-full max-w-sm">
        <h2 class="text-2xl font-bold mb-6">Update Task Status</h2>
        <form
          id="update-task-form"
          onsubmit="event.preventDefault(); updateTaskStatus()"
        >
          <div class="mb-6">
            <label
              for="update-task-status"
              class="block text-sm font-medium mb-1 text-slate-400"
              >New Status</label
            >
            <select
              id="update-task-status"
              class="w-full bg-slate-700 border border-slate-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-sky-500"
              required
            >
              <option value="To Do">To Do</option>
              <option value="In Progress">In Progress</option>
              <option value="Done">Done</option>
            </select>
          </div>
          <input type="hidden" id="update-task-id" />
          <div class="flex gap-4">
            <button
              type="button"
              onclick="closeUpdateTaskModal()"
              class="w-full bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 px-4 rounded-lg transition-colors"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-4 rounded-lg transition-colors"
            >
              Update
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- AI Summary Modal -->
    <div
      id="summary-modal"
      class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop"
    >
      <div class="card w-full max-w-2xl">
        <h2 class="text-2xl font-bold mb-4">‚ú® AI Chat Summary</h2>
        <div
          id="summary-output"
          class="text-slate-300 max-h-[60vh] overflow-y-auto pr-2"
        >
          <p>Generating summary...</p>
        </div>
        <button
          onclick="closeSummaryModal()"
          class="w-full mt-6 bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-lg transition-colors"
        >
          Close
        </button>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div
      id="loading-overlay"
      class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop"
    >
      <div class="loader"></div>
    </div>

    <script>
      // --- App State & Data (Simulating a Backend) ---
      let teamData = {};
      let currentUser = {};
      let tasks = [];

      // --- DOM Elements ---
      const authModal = document.getElementById("auth-modal");
      const appWrapper = document.getElementById("app-wrapper");
      const loadingOverlay = document.getElementById("loading-overlay");
      const summaryModal = document.getElementById("summary-modal");
      const addTaskModal = document.getElementById("add-task-modal");
      const updateTaskModal = document.getElementById("update-task-modal");
      const authCard = document.getElementById("auth-card");

      // --- Gemini API Call Function ---
      async function callGeminiAPI(prompt) {
        loadingOverlay.classList.remove("hidden");
        let chatHistory = [];
        chatHistory.push({ role: "user", parts: [{ text: prompt }] });
        const payload = { contents: chatHistory };
        const apiKey = ""; // API key will be injected by the environment
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

        try {
          const response = await fetch(apiUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
          });

          if (!response.ok) {
            throw new Error(`API call failed with status: ${response.status}`);
          }

          const result = await response.json();

          if (
            result.candidates &&
            result.candidates.length > 0 &&
            result.candidates[0].content &&
            result.candidates[0].content.parts &&
            result.candidates[0].content.parts.length > 0
          ) {
            loadingOverlay.classList.add("hidden");
            return result.candidates[0].content.parts[0].text;
          } else {
            loadingOverlay.classList.add("hidden");
            return "Sorry, I couldn't generate a response. The API returned an unexpected result.";
          }
        } catch (error) {
          console.error("Gemini API Error:", error);
          loadingOverlay.classList.add("hidden");
          return `An error occurred: ${error.message}. Please check the console for details.`;
        }
      }

      // --- AI Feature Functions ---
      async function generatePitch() {
        const pitchInput = document.getElementById("pitch-input");
        const pitchOutput = document.getElementById("pitch-output");
        const aiAssistantSection = document.getElementById(
          "ai-assistant-section"
        );

        if (!pitchInput.value.trim()) {
          pitchOutput.innerHTML =
            '<p class="text-yellow-400">Please enter some bullet points first.</p>';
          return;
        }

        pitchOutput.innerHTML = "<p>Generating your pitch...</p>";
        const prompt = `Based on the following bullet points, generate a compelling and concise project pitch for a hackathon presentation. Make it sound innovative and exciting:\n\n${pitchInput.value}`;

        const response = await callGeminiAPI(prompt);
        pitchOutput.innerHTML = response.replace(/\n/g, "<br>");
        aiAssistantSection.classList.remove("hidden");
      }

      async function getPitchImprovements() {
        const pitchOutput = document.getElementById("pitch-output").innerText;
        const aiAssistantOutput = document.getElementById(
          "ai-assistant-output"
        );

        if (
          !pitchOutput.trim() ||
          pitchOutput.startsWith("Your generated pitch")
        ) {
          aiAssistantOutput.innerHTML =
            '<p class="text-yellow-400">Please generate a pitch first.</p>';
          return;
        }

        aiAssistantOutput.innerHTML = "<p>Analyzing for improvements...</p>";
        const prompt = `Analyze the following hackathon pitch and provide 3 actionable suggestions for improvement. Focus on clarity, impact, and technical feasibility:\n\nPitch:\n"${pitchOutput}"`;

        const response = await callGeminiAPI(prompt);
        aiAssistantOutput.innerHTML = response.replace(/\n/g, "<br>");
      }

      async function summarizeChat() {
        const chatMessagesContainer = document.getElementById("chat-messages");
        const messages =
          chatMessagesContainer.querySelectorAll(".chat-message");
        const summaryOutput = document.getElementById("summary-output");

        if (messages.length === 0) {
          alert("There are no messages to summarize.");
          return;
        }

        let chatTranscript = "";
        messages.forEach((msg) => {
          const author = msg
            .querySelector(".font-semibold")
            .innerText.split(" ")[0];
          const text = msg.querySelector(".message-text").innerText;
          chatTranscript += `${author}: ${text}\n`;
        });

        summaryModal.classList.remove("hidden");
        summaryOutput.innerHTML = "<p>Generating summary...</p>";

        const prompt = `Summarize the key points, decisions, and action items from the following team chat transcript for a hackathon project:\n\n${chatTranscript}`;
        const response = await callGeminiAPI(prompt);
        summaryOutput.innerHTML = response.replace(/\n/g, "<br>");
      }

      function closeSummaryModal() {
        summaryModal.classList.add("hidden");
      }

      // --- New Auth & Team Setup Functions ---

      function showAuthView(viewId) {
        ["initial-view", "login-view", "signup-view", "join-view"].forEach(
          (id) => {
            document.getElementById(id).classList.add("hidden");
          }
        );
        document.getElementById(viewId).classList.remove("hidden");
      }

      function signupLeader() {
        const name = document.getElementById("signup-name").value;
        if (!name) {
          alert("Please enter your name.");
          return;
        }
        currentUser = { name: name, role: "Leader" };
        authModal.classList.add("hidden");
        appWrapper.classList.remove("hidden");
        document.getElementById("right-sidebar").classList.add("hidden"); // Hide sidebar until team is setup
        switchView("team-setup");
        addMemberInput(); // Add first member input field by default
      }

      function addMemberInput() {
        const container = document.getElementById("team-members-container");
        const memberCount = container.children.length;
        const newMemberDiv = document.createElement("div");
        newMemberDiv.className = "flex gap-2";
        newMemberDiv.innerHTML = `
                <input type="text" placeholder="Member ${
                  memberCount + 1
                } Name" class="w-1/2 bg-slate-900 border border-slate-600 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-sky-500" required>
                <select class="w-1/2 bg-slate-900 border border-slate-600 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-sky-500" required>
                    <option value="" disabled selected>Select Role</option>
                    <option value="Frontend">Frontend</option>
                    <option value="Backend">Backend</option>
                    <option value="AI/ML">AI/ML</option>
                    <option value="Designer">Designer</option>
                </select>
            `;
        container.appendChild(newMemberDiv);
      }

      function generateTeamCode() {
        const teamName = document.getElementById("setup-team-name").value;
        const deadlineValue = document.getElementById("setup-deadline").value;
        const memberInputs = document.getElementById(
          "team-members-container"
        ).children;

        if (!deadlineValue) {
          alert("Please set the hackathon deadline.");
          return;
        }
        const deadlineTimestamp = new Date(deadlineValue).getTime();

        let members = [currentUser]; // Add leader to the members list
        for (let i = 0; i < memberInputs.length; i++) {
          const nameInput = memberInputs[i].querySelector('input[type="text"]');
          const roleSelect = memberInputs[i].querySelector("select");
          if (nameInput.value && roleSelect.value) {
            members.push({ name: nameInput.value, role: roleSelect.value });
          }
        }

        if (members.length < 2) {
          alert("Please add at least one team member.");
          return;
        }

        const inviteCode = `HACK-${Math.random()
          .toString(36)
          .substr(2, 4)
          .toUpperCase()}`;

        teamData = {
          name: teamName,
          inviteCode: inviteCode,
          members: members,
          deadline: deadlineTimestamp,
        };

        // Initialize with some default tasks
        tasks = [
          {
            id: 1,
            title: "Design Pitch Deck",
            assignee: members[1]?.name || "Unassigned",
            status: "To Do",
          },
          {
            id: 2,
            title: "Set up Database Schema",
            assignee: members[1]?.name || "Unassigned",
            status: "To Do",
          },
          {
            id: 3,
            title: "Develop Frontend Dashboard",
            assignee: members[0].name,
            status: "In Progress",
          },
          {
            id: 4,
            title: "Create GitHub Repo",
            assignee: "Team",
            status: "Done",
          },
        ];

        console.log("Team Created:", teamData); // For debugging

        const setupView = document.getElementById("view-team-setup");
        setupView.innerHTML = `
                <div class="max-w-2xl mx-auto">
                    <div class="card text-center">
                        <h2 class="text-3xl font-bold mb-2 text-green-400">Team Created!</h2>
                        <p class="text-slate-400 mb-4">Share this code with your team members to join.</p>
                        <div class="bg-slate-900 border-2 border-dashed border-sky-400 rounded-lg p-4 mb-6">
                            <p class="text-4xl font-mono tracking-widest">${inviteCode}</p>
                        </div>
                        <button onclick="enterDashboardAsLeader()" class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-4 rounded-lg transition-colors">Enter Dashboard</button>
                    </div>
                </div>
            `;
      }

      function enterDashboardAsLeader() {
        populateUIWithTeamData();
        document.getElementById("right-sidebar").classList.remove("hidden");
        switchView("dashboard");
        loadDashboard();
      }

      function joinTeam() {
        const code = document.getElementById("join-code").value.toUpperCase();
        const memberSelectContainer = document.getElementById(
          "join-member-select-container"
        );
        const passwordContainer = document.getElementById(
          "join-password-container"
        );
        const joinButton = document.getElementById("join-team-button");

        if (teamData.inviteCode && teamData.inviteCode === code) {
          const memberSelect = document.getElementById("join-member-select");
          memberSelect.innerHTML =
            '<option value="" disabled selected>Select your name</option>';
          teamData.members.forEach((member) => {
            const option = document.createElement("option");
            option.value = member.name;
            option.textContent = member.name;
            memberSelect.appendChild(option);
          });

          memberSelectContainer.classList.remove("hidden");
          passwordContainer.classList.remove("hidden");
          joinButton.textContent = "Join & Enter Dashboard";
          joinButton.onclick = completeJoin;
        } else {
          alert("Invalid Team Code. Please check with your team leader.");
        }
      }

      function completeJoin() {
        event.preventDefault();
        const selectedName =
          document.getElementById("join-member-select").value;
        if (!selectedName) {
          alert("Please select your name.");
          return;
        }
        currentUser = teamData.members.find((m) => m.name === selectedName);

        authModal.classList.add("hidden");
        appWrapper.classList.remove("hidden");
        populateUIWithTeamData();
        loadDashboard();
      }

      function populateUIWithTeamData() {
        document.getElementById("user-name").textContent = currentUser.name;
        document.getElementById(
          "user-avatar"
        ).src = `https://placehold.co/40x40/38bdf8/ffffff?text=${currentUser.name.charAt(
          0
        )}`;
        document.getElementById("dashboard-team-name").textContent =
          teamData.name;
        document.getElementById("settings-team-name").value = teamData.name;
        document.getElementById("settings-invite-code").value =
          teamData.inviteCode;

        const sidebarList = document.getElementById("sidebar-members-list");
        const settingsList = document.getElementById("settings-members-list");
        sidebarList.innerHTML = "";
        settingsList.innerHTML = "";

        teamData.members.forEach((member) => {
          const avatar = `https://placehold.co/32x32/1e293b/ffffff?text=${member.name.charAt(
            0
          )}`;
          const sidebarItem = document.createElement("li");
          sidebarItem.className = "flex items-center gap-3";
          sidebarItem.innerHTML = `
                    <img src="${avatar}" class="w-8 h-8 rounded-full" alt="${member.name}"/>
                    <div><p class="font-medium">${member.name}</p><p class="text-xs text-slate-400">${member.role}</p></div>
                `;
          sidebarList.appendChild(sidebarItem);

          const settingsItem = document.createElement("div");
          settingsItem.className =
            "flex justify-between items-center p-3 bg-slate-900 rounded-lg";
          settingsItem.innerHTML = `
                    <div class="flex items-center gap-3">
                        <img src="${avatar}" class="w-10 h-10 rounded-full" alt="${member.name}"/>
                        <p class="font-semibold">${member.name}</p>
                    </div>
                    <span class="text-sm text-slate-400">${member.role}</span>
                `;
          settingsList.appendChild(settingsItem);
        });
      }

      // --- Task Management Functions ---
      function openAddTaskModal() {
        const assigneeSelect = document.getElementById("task-assignee");
        assigneeSelect.innerHTML = "";
        teamData.members.forEach((member) => {
          const option = document.createElement("option");
          option.value = member.name;
          option.textContent = member.name;
          assigneeSelect.appendChild(option);
        });
        addTaskModal.classList.remove("hidden");
      }

      function closeAddTaskModal() {
        addTaskModal.classList.add("hidden");
        document.getElementById("add-task-form").reset();
      }

      function addTask() {
        const title = document.getElementById("task-title").value;
        const assignee = document.getElementById("task-assignee").value;

        const newTask = {
          id: Date.now(), // simple unique ID
          title: title,
          assignee: assignee,
          status: "To Do",
        };
        tasks.push(newTask);
        renderAllDynamicContent();
        closeAddTaskModal();
      }

      function openUpdateTaskModal(taskId) {
        const task = tasks.find((t) => t.id === taskId);
        if (task) {
          document.getElementById("update-task-id").value = taskId;
          document.getElementById("update-task-status").value = task.status;
          updateTaskModal.classList.remove("hidden");
        }
      }

      function closeUpdateTaskModal() {
        updateTaskModal.classList.add("hidden");
      }

      function updateTaskStatus() {
        const taskId = parseInt(
          document.getElementById("update-task-id").value
        );
        const newStatus = document.getElementById("update-task-status").value;
        const task = tasks.find((t) => t.id === taskId);
        if (task) {
          task.status = newStatus;
          renderAllDynamicContent();
        }
        closeUpdateTaskModal();
      }

      function renderTaskBoard() {
        const todoCol = document.getElementById("tasks-todo");
        const inprogressCol = document.getElementById("tasks-inprogress");
        const doneCol = document.getElementById("tasks-done");

        todoCol.innerHTML = "";
        inprogressCol.innerHTML = "";
        doneCol.innerHTML = "";

        tasks.forEach((task) => {
          const taskCard = document.createElement("div");
          taskCard.className = "card p-4";
          if (task.status === "Done") {
            taskCard.classList.add("opacity-70");
          }
          taskCard.innerHTML = `
                    <p class="font-semibold ${
                      task.status === "Done" ? "line-through" : ""
                    }">${task.title}</p>
                    <p class="text-sm text-slate-400 mt-1">Assigned to: ${
                      task.assignee
                    }</p>
                    <button onclick="openUpdateTaskModal(${
                      task.id
                    })" class="text-xs mt-3 bg-slate-600 hover:bg-slate-700 text-white py-1 px-3 rounded-md">Update Status</button>
                `;
          if (task.status === "To Do") {
            todoCol.appendChild(taskCard);
          } else if (task.status === "In Progress") {
            inprogressCol.appendChild(taskCard);
          } else {
            doneCol.appendChild(taskCard);
          }
        });
      }

      function renderAllDynamicContent() {
        renderTaskBoard();
        createProgressChart();
        // Could add other render functions here in the future
      }

      // --- Existing UI Functions (Modified) ---
      function login() {
        if (!teamData.name) {
          alert(
            "No team has been created yet. Please sign up to create a team or join one with a code."
          );
          return;
        }
        currentUser = teamData.members[0];
        authModal.classList.add("hidden");
        appWrapper.classList.remove("hidden");
        populateUIWithTeamData();
        loadDashboard();
      }

      function logout() {
        teamData = {};
        currentUser = {};
        tasks = [];
        appWrapper.classList.add("hidden");
        authModal.classList.remove("hidden");
        showAuthView("initial-view");
      }

      function switchView(viewName) {
        document.querySelectorAll(".view-content").forEach((view) => {
          view.classList.add("hidden");
        });
        document.getElementById(`view-${viewName}`).classList.remove("hidden");

        document.querySelectorAll(".nav-item").forEach((item) => {
          item.classList.remove("active");
        });

        const activeNavItem = document.querySelector(
          `.nav-item[data-view="${viewName}"]`
        );
        if (activeNavItem) {
          activeNavItem.classList.add("active");
        }
      }

      function loadDashboard() {
        renderAllDynamicContent();
        startTimer();
      }

      let progressChartInstance = null;
      function createProgressChart() {
        const ctx = document.getElementById("progressChart").getContext("2d");

        if (progressChartInstance) {
          progressChartInstance.destroy();
        }

        const doneCount = tasks.filter((t) => t.status === "Done").length;
        const inProgressCount = tasks.filter(
          (t) => t.status === "In Progress"
        ).length;
        const todoCount = tasks.filter((t) => t.status === "To Do").length;

        const data = {
          labels: ["Done", "In Progress", "To Do"],
          datasets: [
            {
              data: [doneCount, inProgressCount, todoCount],
              backgroundColor: [
                "#22c55e", // green-500
                "#f59e0b", // amber-500
                "#ef4444", // red-500
              ],
              borderColor: "#1e293b", // slate-800
              borderWidth: 4,
              hoverOffset: 8,
            },
          ],
        };

        progressChartInstance = new Chart(ctx, {
          type: "doughnut",
          data: data,
          options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: "70%",
            plugins: {
              legend: {
                position: "bottom",
                labels: {
                  color: "#94a3b8", // slate-400
                  font: {
                    size: 14,
                  },
                },
              },
              tooltip: {
                callbacks: {
                  label: function (context) {
                    let label = context.label || "";
                    if (label) {
                      label += ": ";
                    }
                    if (context.parsed !== null) {
                      label += context.parsed + " tasks";
                    }
                    return label;
                  },
                },
              },
            },
          },
        });
      }

      let timerInterval;
      function startTimer() {
        const timerEl = document.getElementById("timer");
        if (timerInterval) clearInterval(timerInterval);

        if (!teamData.deadline) {
          timerEl.textContent = "Not Set";
          return;
        }

        const updateTimer = () => {
          const now = new Date().getTime();
          const distance = teamData.deadline - now;

          if (distance < 0) {
            clearInterval(timerInterval);
            timerEl.textContent = "EXPIRED";
            return;
          }

          const days = Math.floor(distance / (1000 * 60 * 60 * 24));
          const hours = Math.floor(
            (distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
          )
            .toString()
            .padStart(2, "0");
          const minutes = Math.floor(
            (distance % (1000 * 60 * 60)) / (1000 * 60)
          )
            .toString()
            .padStart(2, "0");
          const seconds = Math.floor((distance % (1000 * 60)) / 1000)
            .toString()
            .padStart(2, "0");

          if (days > 0) {
            timerEl.textContent = `${days}d ${hours}:${minutes}:${seconds}`;
          } else {
            timerEl.textContent = `${hours}:${minutes}:${seconds}`;
          }
        };

        updateTimer(); // Initial call
        timerInterval = setInterval(updateTimer, 1000);
      }
    </script>
  </body>
</html>
